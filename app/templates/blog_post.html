{% extends "base.html" %}

{% block content %}
<article>
  <h1>{{ post.title }}</h1>
  <p><em>Published on {{ post.created_at.strftime("%b %d, %Y") }} by {{ post.author.name }}</em></p>

  <div class="tags-section" style="margin: 1em 0;">
    <strong>Tags:</strong>
    {% if post.tags.all() %}
      {% for tag in post.tags %}
      <a href="{{ url_for('blog.posts_by_tag', tag_name=tag.name) }}"
        style="text-decoration:none; background-color:#eee; padding: 2px 6px; border-radius: 4px; margin-right: 5px;">
        {{ tag.name }}
      </a>
      {% endfor %}
    {% else %}
      <span>No tags</span>
    {% endif %}
  </div>

  {% if post.image_path %}
  <img src="{{ url_for('static', filename='uploads/' ~ post.image_path) }}" alt="Post image"
    style="max-width:100%; height:auto; margin:1em 0;">
  {% endif %}
  
  <div>{{ rendered_content|safe }}</div>
</article>

{% if current_user.is_authenticated 
  and (current_user.role == "admin" or current_user.id == post.author_id) 
  and post.post_type != 1 %}
<form action="{{ url_for('blog.delete_post', post_id=post.id) }}" method="POST" style="margin-top: 1em;">
  <button type="submit" style="color:red; background:none; border:none; padding:0; cursor:pointer; font-size: 1em;">
    🗑 Delete Post
  </button>
</form>
{% endif %}

<a href="{{ url_for('blog.blog_list_view') }}" style="display:inline-block; margin-top: 1em;">← Back to blog</a>
{% endblock %}